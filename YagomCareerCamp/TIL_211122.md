## **TIL(Today I Learned)**

11. 22(월)

# ARC

### 메모리 구조

- 프로세스 메모리는 추상화를 통해 코드 / 데이타 / 스택 / 힙 4개의 영역으로 나뉜다.
    - 코드 : 프로그램의 코드 그대로가 저장되는 영역(기계어) / 컴파일 시점에 결정됨 / 읽기전용
    - 데이타 : 전역변수와 static 변수가 저장되는 영역 / 프로그램의 시작 종료에 따라 할당, 소멸 / 읽기 쓰기 가능
    - 스택 : 지역변수와 매개변수가 저장되는 영역 / 함수의 호출에 따라 할당, 소멸한다 / 컴파일 시점에 할당
    - 힙 : 동적으로 할당할 수 있음. 할당 후 적절한 시점에서 해제가 필요하다. → ARC / 런타임 도중 동적으로 바뀌기 때문에 데이터의 크기가 확실하지 않을 때 사용? / 클래스 인스턴스, 클로저
    - 스택과 힙은 메모리에서 같은 영역을 공유하고 있으며 가득 차게 되면 스택오버플로우 발생

### ARC?

- 스위프트는 ARC를 사용하여 메모리 사용량을 추적하고 관리한다.
- 클래스의 인스턴스 혹은 클로져가 참조될 때마다 카운트를 + 1 해준다.
- 참조가 없어질 때 - 1 해주고, 0이 되는 시점에 메모리에서 해제시킨다.
- 원리 : 컴파일 시점에 retain 과 release 메소드를 적절한 코드에 삽입하는 것 → 따라서 해당 메소드 때문에 발생할 수 있는 문제를 개발자가 인지하고 적절한 조치를 취해야 한다.
- 강한 참조 및 약한참조 그리고 강한참조에서 발생할 수 있는 문제에 대해서 인지해야 한다.
- 미소유 참조의 경우 약한참조와 비교했을 때, 참조하는 대상에 추적을 하지 않고 당연히 있는 것으로 생각하는 것이다. 따라서 미소유 참조를 사용했을 때 메모리에서 해제될 시 해당 대상에 접근하면 Crash가 발생한다.

### ARC 이전의 메모리 관리

- MRC in Objective-C
- 수동으로 retain, relase 등의 메소드를 사용하여 관리 해 줘야 했다.

### 느낀것, 더 공부해볼 것

- 공식문서 번역하면서 정독해보기!